{% extends "base.html" %}
{% block title %}Provider Details{% endblock %}
{% block head %}
<style>
body{background:linear-gradient(135deg,#eef2f7 0%,#f9fbff 100%)}
.card{border:none;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.08);overflow:hidden}
.avatar{width:64px;height:64px;border-radius:50%;background:#4c6fff;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:24px}
.chip{display:inline-block;background:#f1f5ff;color:#2b4eff;border:1px solid #dbe6ff;border-radius:999px;padding:6px 10px;margin:4px 6px 0 0;font-size:12px}
.section-title{font-weight:700;margin-top:18px;margin-bottom:10px}
.pricing{display:flex;gap:10px;flex-wrap:wrap}
.price-badge{background:#e6ffed;color:#046a38;border:1px solid #b7f3c5;border-radius:10px;padding:6px 10px;font-size:12px}
.charge-badge{background:#fff7e6;color:#8a5700;border:1px solid #ffe0a3;border-radius:10px;padding:6px 10px;font-size:12px}
.action-row{display:flex;gap:10px;flex-wrap:wrap}
.btn-soft{background:#f4f6fb;border:1px solid #e3e8f5}
</style>
{% endblock %}
{% block content %}
<div class="container py-3">
  <div class="card p-3 p-md-4 mb-3">
    <div class="d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-3">
        <div class="avatar">{{ provider.name|slice:":1"|upper }}</div>
        <div>
          <h3 class="m-0">{{ provider.name }}</h3>
          <div class="text-muted">{{ provider.location }}</div>
        </div>
      </div>
      <div class="action-row">
        <a class="btn btn-soft" target="_blank" href="tel:{{ provider.phone }}">Call</a>
        <a class="btn btn-soft" target="_blank" href="https://wa.me/{{ provider.phone }}?text=Hello%20{{ provider.name }}">WhatsApp</a>
      </div>
    </div>
    <div class="mt-3">
      {% for c in provider.categories.all %}
        <span class="chip">{{ c.category_name }}</span>
      {% empty %}
        <span class="text-muted">No categories</span>
      {% endfor %}
    </div>
  </div>

  <div class="card p-3 p-md-4 mb-3">
    <div class="section-title">Services Offered</div>
    <div class="row g-3">
      {% for c in provider.categories.all %}
      <div class="col-md-6">
        <div class="p-3 border rounded-3 bg-white h-100">
          <div class="d-flex align-items-center justify-content-between mb-1">
            <strong>{{ c.category_name }}</strong>
            <div class="pricing">
              {% if c.rent_value %}
              <span class="price-badge">Rent: ₹{{ c.rent_value }}</span>
              {% endif %}
              {% if c.other_charges %}
              <span class="charge-badge">Other: ₹{{ c.other_charges }}</span>
              {% endif %}
            </div>
          </div>
          {% if c.description %}
          <div class="text-muted">{{ c.description }}</div>
          {% else %}
          <div class="text-muted">No description provided.</div>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  </div>

  <div class="card p-3 p-md-4">
    <div class="section-title">Hire {{ provider.name }}</div>
    <form method="post" action="{% url 'hire_provider' provider.pk %}">
      {% csrf_token %}
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Select Service</label>
          <select name="service_name" class="form-select">
            {% for c in provider.categories.all %}
              <option value="{{ c.category_name }}">{{ c.category_name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-6 d-flex align-items-end">
          <button type="submit" class="btn btn-primary">Hire</button>
          <a href="{% url 'browse_services' %}" class="btn btn-secondary ms-2">Back</a>
        </div>
      </div>
    </form>
  </div>
</div>
{% endblock %}
