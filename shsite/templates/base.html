<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}{% endblock %}</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
:root{
  --sidebar-width:260px;
  --sidebar-width-collapsed:72px;
  --topbar-height:64px;
  --bg:#0f172a;
  --bg-soft:#111827;
  --card:#111827;
  --text:#e5e7eb;
  --accent:#60a5fa;
  --accent-2:#a78bfa;
}
html,body{height:100%}
body{background-color:var(--bg);color:var(--text)}
.layout{display:flex;min-height:100vh}
.main{flex:1;min-width:0;display:flex;flex-direction:column}
.sidebar{
  position:sticky;top:0;left:0;height:100vh;width:var(--sidebar-width);
  background:linear-gradient(180deg,#0b1020,#0d1326 60%,#0f172a);
  border-right:1px solid rgba(255,255,255,.06);
  box-shadow:inset -1px 0 0 rgba(255,255,255,.04);
  transition:width .28s ease, transform .28s ease;
  will-change:width,transform;
  z-index:1040;
}
body.sidebar-collapsed .sidebar{width:var(--sidebar-width-collapsed)}
.sidebar-header{
  display:flex;align-items:center;gap:10px;padding:12px 14px 12px 12px
}
.sidebar-toggle{
  appearance:none;border:none;background:#1f2937;color:#fff;
  width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;
  box-shadow:0 2px 8px rgba(0,0,0,.35);
  transition:transform .18s ease, background .2s ease, box-shadow .2s ease;
}
.sidebar-toggle .icon{font-size:18px;line-height:1}
.sidebar-toggle:hover{background:#374151;transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.4)}
.sidebar-toggle:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
.brand{font-weight:600;letter-spacing:.2px;color:#fff;opacity:.92;white-space:nowrap}
body.sidebar-collapsed .brand{opacity:.0;pointer-events:none}
.sidebar-nav{display:flex;flex-direction:column;padding:8px}
.nav-section{margin:6px 4px 10px}
.section-title{font-size:.78rem;letter-spacing:.08em;text-transform:uppercase;color:#9ca3af;margin:8px 6px}
.user-card{display:flex;align-items:center;gap:10px;padding:10px 12px;margin:4px;border:1px solid rgba(255,255,255,.06);border-radius:12px;background:#0b1224}
.avatar{width:36px;height:36px;border-radius:50%;background:#1f2937;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
.sidebar-nav .nav-link{
  color:#cbd5e1;border-radius:8px;padding:10px 12px;margin:2px 4px;
  transition:background .2s ease,color .2s ease, transform .18s ease;
}
.sidebar-nav .nav-link:hover{background:#1f2937;color:#fff;transform:translateX(2px)}
.topbar{
  position:sticky;top:0;height:var(--topbar-height);
  backdrop-filter:saturate(180%) blur(8px);
  background:rgba(17,24,39,.6);
  border-bottom:1px solid rgba(255,255,255,.06);
  z-index:1030;
}
.content{
  flex:1;min-width:0;
}
.menu-item{position:relative}
.menu-item a{color:#e5e7eb}
.menu-item a:hover{color:#fff}
.menu-item .underline{
  position:absolute;left:0;bottom:-6px;height:2px;width:0;background:linear-gradient(90deg,var(--accent),var(--accent-2));
  transition:width .25s ease
}
.menu-item:hover .underline{width:100%}
@media (max-width:992px){
  .sidebar{position:sticky;width:var(--sidebar-width-collapsed);transform:none;box-shadow:none}
  body:not(.sidebar-collapsed) .sidebar{width:var(--sidebar-width)}
}
</style>
{% block head %}{% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}">
<div class="layout">
  <aside id="sidebar" class="sidebar" aria-label="Primary">
    <div class="sidebar-header">
      <button id="sidebarToggle" class="sidebar-toggle" aria-label="Toggle sidebar" aria-controls="sidebar" aria-expanded="true">
        <span class="icon">&#9776;</span>
      </button>
      <span class="brand">ServicesHand</span>
    </div>
    {% if app_user %}
    <div class="user-card">
      <div class="avatar">{{ app_user.name|slice:":1"|upper }}</div>
      <div>
        <div class="fw-semibold">{{ app_user.name }}</div>
        <a href="{% url 'edit_profile' %}" class="text-decoration-none" style="color:#93c5fd">Edit profile</a>
      </div>
    </div>
    {% endif %}
    <nav class="sidebar-nav" role="navigation">
      <div class="nav-section">
        <div class="section-title">Explore</div>
        <a href="{% url 'home' %}" class="nav-link">Home</a>
        <a href="{% url 'browse_services' %}" class="nav-link">Browse Services</a>
      </div>
      <div class="nav-section">
        <div class="section-title">Account</div>
        {% if app_user %}
        <a href="{% url 'user_dashboard' %}" class="nav-link">User Dashboard</a>
        <a href="{% url 'change_password' %}" class="nav-link">Change Password</a>
        <a href="{% url 'logout' %}" class="nav-link">Logout</a>
        {% else %}
        <a href="{% url 'register' %}" class="nav-link">Register</a>
        <a href="{% url 'login' %}" class="nav-link">Login</a>
        {% endif %}
      </div>
    </nav>
  </aside>
  <div class="main">
    <header class="topbar">
      <nav class="navbar navbar-expand-lg px-3" aria-label="Main navigation">
        <button class="navbar-toggler text-white border-0" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end text-end" id="mainNav">
          <ul class="navbar-nav mb-2 mb-lg-0 gap-lg-3">
            <li class="nav-item menu-item"><a class="nav-link" href="{% url 'browse_services' %}">Services</a><span class="underline"></span></li>
            <li class="nav-item menu-item"><a class="nav-link" href="#providers">Providers</a><span class="underline"></span></li>
            <li class="nav-item menu-item"><a class="nav-link" href="#about">About</a><span class="underline"></span></li>
            <li class="nav-item menu-item"><a class="nav-link" href="#contact">Contact</a><span class="underline"></span></li>
          </ul>
        </div>
      </nav>
    </header>
    <main id="content" class="content">
      <div class="container mt-3">
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endif %}
      </div>
      {% block content %}{% endblock %}
    </main>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
const body=document.body;
const btn=document.getElementById('sidebarToggle');
const SIDEBAR_STATE_KEY='sh.sidebar.state';
function setExpanded(expanded){btn?.setAttribute('aria-expanded',expanded.toString());}
function applyState(state){const collapsed=state==='collapsed';body.classList.toggle('sidebar-collapsed',collapsed);setExpanded(!collapsed);}
function toggle(){const next=body.classList.contains('sidebar-collapsed')?'expanded':'collapsed';localStorage.setItem(SIDEBAR_STATE_KEY,next);applyState(next);}
const saved=localStorage.getItem(SIDEBAR_STATE_KEY)||'expanded';applyState(saved);
btn?.addEventListener('click',toggle);
const observer=new IntersectionObserver((entries)=>{entries.forEach(e=>{if(e.isIntersecting){e.target.classList.add('reveal');observer.unobserve(e.target);}});},{threshold:.15});
document.querySelectorAll('.reveal-on-scroll').forEach(el=>observer.observe(el));
let ticking=false;
function parallax(){document.querySelectorAll('[data-parallax]').forEach(el=>{const speed=parseFloat(el.getAttribute('data-speed')||'0.3');const rect=el.getBoundingClientRect();const y=rect.top;el.style.backgroundPosition=`center ${y*speed}px`;});ticking=false;}
window.addEventListener('scroll',()=>{if(!ticking){window.requestAnimationFrame(parallax);ticking=true;}},{passive:true});
</script>
</body>
</html>
